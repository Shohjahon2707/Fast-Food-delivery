{% extends "base.html" %}
{% block title %}–ö–æ—Ä–∑–∏–Ω–∞{% endblock %}

{% block content %}
<div class="container my-5">
    <h2 class="text-center mb-4">üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h2>

    {% if cart.items.all %}
        <div class="table-responsive shadow-sm rounded">
            <table class="table table-bordered text-center align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>–¢–æ–≤–∞—Ä</th>
                        <th>–¶–µ–Ω–∞</th>
                        <th>–ö–æ–ª-–≤–æ</th>
                        <th>–ò—Ç–æ–≥–æ</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in cart.items.all %}
                    <tr>
                        <td class="fw-semibold">{{ item.menu_item.name }}</td>
                        <td>{{ item.menu_item.price }} UZS</td>
                        <td>
                            <form method="post" action="{% url 'update_quantity' item.id %}" class="d-flex justify-content-center">
                                {% csrf_token %}
                                <input type="number" name="quantity" value="{{ item.quantity }}" min="1" 
                                       class="form-control form-control-sm w-50 me-2 text-center">
                                <button type="submit" class="btn btn-sm btn-primary">–û–±–Ω–æ–≤–∏—Ç—å</button>
                            </form>
                        </td>
                        <td class="fw-bold">{{ item.total }} UZS</td>
                        <td>
                            <a href="{% url 'remove_from_cart' item.id %}" class="btn btn-sm btn-danger">‚ùå</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="d-flex justify-content-between align-items-center mt-4">
            <a href="{% url 'menu_list' %}" class="btn btn-secondary">‚¨Ö –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</a>

            <div class="text-end">
                <h4>–û–±—â–∞—è —Å—É–º–º–∞: <span class="text-success">{{ cart.total_price }} UZS</span></h4>
                
                <!-- –ö–ù–û–ü–ö–ò –û–ü–õ–ê–¢–´ -->
<div class="mt-3">
    <form method="post" action="{% url 'create_order' %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-lg btn-success me-2">üí≥ –û–ø–ª–∞—Ç–∏—Ç—å –∫–∞—Ä—Ç–æ–π</button>
    </form>
    <!-- –û—Ç–¥–µ–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –Ω–∞–ª–∏—á–Ω—ã—Ö -->
    <form method="post" action="{% url 'create_order' %}">
        {% csrf_token %}
        <input type="hidden" name="payment_method" value="cash">
        <button type="submit" class="btn btn-lg btn-warning mt-2">üíµ –û–ø–ª–∞—Ç–∏—Ç—å –Ω–∞–ª–∏—á–Ω—ã–º–∏</button>
    </form>
</div>

    {% else %}
        <p class="text-center fs-5">–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞ üõç</p>
        <div class="text-center mt-4">
            <a href="{% url 'menu_list' %}" class="btn btn-lg btn-success">üçî –ü–µ—Ä–µ–π—Ç–∏ –≤ –º–µ–Ω—É</a>
        </div>
    {% endif %}
</div>
{% endblock %}